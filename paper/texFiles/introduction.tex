\section{Introduction}
Most biomaterials exhibit significant nonlinear deformation behavior, and hyperelastic models are often used to model this behavior. Hyperelastic models have been successfully applied on many different kinds of biological materials. For example, it is reported in \cite{Qian}, the cell wall of onion epidermis could be modeled with anisotropic hyperelastic model, agreeing well with experimental data. In  \cite{OHagen}, a hyperelastic model is used to model Breast tissue and it is found that the material parameters of pathological tissues are significantly different from the healthy tissue. Differences in parameters are also found when the hyperelastic model is used to measure malignant tumors and benign tumors \cite{Oberai}. Another type of applications involves vessels. \cite{Zidi} shows that rat carotid artery can be modeled with a hyperelastic model, and agreement with experimental results is achieved. Human carotid artery is also modeled with hyperelastic model in \cite{Zidi2}. More recently, in \cite{Bols}, a hyperelastic model is used to simulate the stress distribution of the patient-specific vessels.
Other than these, numerous applications to the brain \cite{Karimi, Samani, Gilchrist}; the lung \cite{Wall, Wall2}; liver and kidney \cite{Fu, Untaroiu, Willinger} are reported. For a detailed review, please refer to \cite{Kupriyanova}.

According to \cite{Steinmann}, hyperelastic models can be classified as phenomenological or micro-mechanical. The latter are derived from statistical mechanics arguments on networks of idealized chain molecules while the former utilise more or less complex, frequently polynomial formulations in terms of strain invariants or principle stretches. We restrict the scope of this paper to the phenomenological models using principle invariants as they are the majority of the hyperelastic models and have more common characteristics. Among these models we pick out three extremely popular ones as examples: Mooney-Rivlin model, Yeoh model and HGO model.

In order to implement hyperelastic models in the finite element code, two key expressions are necessary. One is the expression of stress, which is used to form the equilibrium equation we want to solve; the other is the elasticity tensor, which is used to form the tangent stiffness matrix we use to solve the equilibrium equation.  Although hyperelastic models have been developed and implemented for many years, there is few papers or books on how to find these expressions, especially for the elasticity tensors.  An indicial method to derive the stress and elasticity tensor for Mooney-Rivlin model is presented in \cite{Bower}, which in the author's opinion, is not easy to be transplanted to another model. In \cite{Belytschko}, a general method to find the tangent stiffness matrix for any hyperelastic model based on index notation is introduced in an abstract form with no detailed example presented. A step-by-step method written in non-indicial form is derived in \cite{Holzapfel}, which we refer to a lot in this paper. But again limited examples are shown in this book. Some derivations for specific models can be found in some early publications \cite{Weiss, Nicholson}.

To the best of the author's knowledge, there is no paper or book that gives a thorough introduction to the general method to derive the stress and elasticity tensor expressions from a given hyperelastic model. This is one of the motivations of this paper. Another key difficulty in the area of nonlinear finite element formulation is the mixed formulation. As known to all, as the compressibility of the material becomes small, the tangent stiffness matrix (or the stiffness matrix in linear finite element formulation) becomes ill-conditioned. To solve this problem, the mixed formulation was first discussed in the context of linear elasticity by Fraeijs de Veubeke \cite{Veubeke} and Herrmann \cite{Herrmann}. The first attempt to apply mixed formulation to nonlinear materials dates back to the late 1960s \cite{Oden}. While the first successful application to rubberlike materials was done by Borst \cite{Borst}, in which several practical problems are solved. A number of more recent books discuss the topic of mixed formulation as well, including \cite{Bathe}, \cite{Holzapfel}, \cite{Zienkiewicz}, etc. However, few of these publications gives a workflow of the detailed implementation, which makes the mixed formulation hard to learn for modern researchers. Therefore the other motivation of this paper is to walk through the displacement/pressure mixed formulation. 

This paper is organized in the following way: in the second section, we introduce some basics of the hyperelastic model followed by the general procedures to derive the stress and elasticity tensor. With three different example, we show how to substitute the specific models into the general formulations. Both isotropic and anisotropic models are covered in these examples. In the third section, we briefly review the theory of principle of virtual work and principle of stationary potential energy. With these theories, the origin of mixed formulation is introduced and is further written in the matrix form. Along the way we also discuss the pressure load which is common in biomechanics while more difficult to implement than the obvious given traction because it involves the deformation of the loaded surface. To complete the finite element formulation in solving hyperelastic material problems, the linearization of the principle of stationary potential energy is introduced. In the fourth section, two sets of numerical experiments are presented: our derivation for the isotropic models is validated quantitatively while that for the anisotropic model also gains expected results in the biaxial tension test. The vessel expansion test is more challenging because axisymmetric results are expected. We use Mooney-Rivlin model as a benchmark and compare the computational results to the analytical solutions. Good agreement is achieved on Mooney-Rivlin model, after which we compare the performance of different models in the same vessel expansion case where reasonable results are presented. Finally we use the Holzapfel-Gasser-Ogden (HGO) model to simulate a real layered rabbit carotid artery vessel. The results show that the stress gradient is significant in the inner layer but negligible in the outer layer.

 



