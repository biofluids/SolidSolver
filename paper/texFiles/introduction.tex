\section{Introduction}
Hyperelastic models have been successfully applied to various types of biomaterial scaling from onion epidermis \cite{Qian} to breast tissues \cite{OHagen}, from carotid vessels \cite{Zidi, Zidi2, Bols} to breast tumors \cite{Oberai}, and a number of animal organs including brain \cite{Karimi, Samani, Gilchrist}, lung  \cite{Wall, Wall2}, liver and kidney \cite{Fu, Untaroiu, Willinger}. For a detailed review, please refer to \cite{Kupriyanova}.
According to \cite{Steinmann}, hyperelastic models can be classified as phenomenological or micro-mechanical. The latter are derived from statistical mechanics arguments on networks of idealized chain molecules while the former utilize more or less complex, frequently polynomial formulations in terms of strain invariants or principle stretches. Because of the popularity of hyperelastic models, many commercial software have them built in. For instance, Abaqus FEA offers Mooney-Rivlin model, Yeoh model, neo-Hookean model, etc. It also allows the user to provide a subroutine to define new models. But there are certain limitations with commercial software. One of them is that it is unable to model completely incompressible material so that it can maintain the robustness of the computation \cite{Abaqus}. However we will show in this paper, with some simple modifications, complete incompressibility can be easily implemented based on nearly incompressible models.

Although hyperelastic models have been frequently used with finite element method to model the nonlinear deformation behavior, it is not straightforward to implement them because two key issues are vaguely addressed in literature. The first obstacle to implement hyperelastic models is to derive the stress and elasticity tensors for the model. The stress tensor is used to form the equilibrium equation, and the elasticity tensor is the keystone to form the tangent stiffness matrix that is used to solve the equilibrium equation. And the second one is the implementation of the mixed formulation. As known to all, as the compressibility of the material becomes small, the tangent stiffness matrix becomes ill-conditioned. Furthermore, for completely incompressible material, the hydrostatic pressure is arbitrary. Therefore it must be an independent unknown. With the mixed formulation, we are able to solve nearly or completely incompressible material easily. 

Regarding to the first challenge, there are few papers or books addressing the systematic method to find stress and elasticity tensors. An indicial method to derive the stress and elasticity tensor for Mooney-Rivlin model is presented in \cite{Bower}, which in the author's opinion, is not easy to be transplanted to another model. In \cite{Belytschko}, a general method to find the tangent stiffness matrix for any hyperelastic model based on index notation is introduced in an abstract form with no detailed example presented. A step-by-step method written in non-indicial form is derived in \cite{Holzapfel}, which we refer to a lot in this paper. But again limited examples are shown in this book. Some derivations for specific models can be found in some early publications \cite{Weiss, Nicholson}. A more recent paper \cite{Suchocki} presents the implementation of Knowles model with Abaqus, using a similar approach in this paper.

The mixed formulation was initially discussed in the context of linear elasticity by Fraeijs de Veubeke \cite{Veubeke} and Herrmann \cite{Herrmann}. The first attempt to apply mixed formulation to nonlinear materials dates back to the late 1960s \cite{Oden}. While the first successful application to rubberlike materials was done by Borst \cite{Borst}, in which several practical problems are solved. A number of more recent books discuss the topic of mixed formulation as well, including \cite{Bathe}, \cite{Holzapfel}, \cite{Zienkiewicz}, etc. Although mixed formulation has been well developed, unfortunately few of these publications gives a workflow of the detailed implementation, which makes the mixed formulation hard to learn for the beginners. 

This paper is motivated to clarify these frustrating problems and walk the readers through the standard solution. We will build a framework for the implementation of hyperelastic models starting from the decoupling of the strain-energy function. We will derive the general form of the stress and elasticity tensors, in which all the variables and operations are carefully defined to avoid ambiguity. To demonstrate the generalness of our derivation, we present three examples: Mooney-Rivlin model, Yeoh model and HGO model. Mooney-Rivlin and Yeoh model are both isotropic models written as polynomial functions of invariants $\bar{I}_1$, $\bar{I}_2$ and $J$. The former is a first-order model but 


With the detailed derivation and the neat workflow, readers should be able to quickly implement any hyperelastic model with the standard displacement-based formulation or the mixed formulation. This is not only useful to the researchers who develop their own finite element code but also to those who work with commercial codes with a user-defined routine to include new constitutive models.

We restrict the scope of this paper to the phenomenological models using principle invariants as they are the majority of the hyperelastic models and have more common characteristics. Among these models we pick out three extremely popular ones as examples: Mooney-Rivlin model, Yeoh model and HGO model.

All the models in this paper are decoupled into a isochoric part and a volumeric part, which is a standard way to treat the nearly incompressible, rubberlike material because they have quite different bulk and shear behavior. It also allows us to use the volumetric part as a penalty or Lagrange multiplier term to enforce the slight compressibility. All the isotropic models are written in three invariants $\bar{I}_1$, $\bar{I}_2$ and $J$, including both polynomial and exponential forms. On the other hand, the anisotropic model is built on a isotropic ground model and additional terms to represent the alignment of directional fibers. With these example models, any the hyperelastic model written in invariants can be solved in a similar way.

The rest of this paper is organized in the following way: in the second section, we introduce some basics of the hyperelastic model followed by the general procedures to derive the stress and elasticity tensor. With three different example, we show how to substitute the specific models into the general formulations. In the third section, we briefly review the theory of principle of virtual work and principle of stationary potential energy. With these theories, the origin of mixed formulation is introduced and is further written in the matrix form. Along the way we also discuss the pressure load which is common in biomechanics while more difficult to implement than the obvious given traction because it involves the deformation of the loaded surface. To complete the finite element formulation in solving hyperelastic material problems, the linearization of the principle of stationary potential energy is introduced. In the fourth section, two sets of numerical experiments are presented: our derivation for the isotropic models is validated quantitatively while that for the anisotropic model also gains expected results in the biaxial tension test. The vessel expansion test is more challenging because axisymmetric results are expected. We use Mooney-Rivlin model as a benchmark and compare the computational results to the analytical solutions. Good agreement is achieved on Mooney-Rivlin model, after which we compare the performance of different models in the same vessel expansion case where reasonable results are presented. Finally we use the Holzapfel-Gasser-Ogden (HGO) model to simulate a real layered rabbit carotid artery vessel as a demonstration of the real applications.


 



